# 디폴트 메서드(Default Method)
자바 8에는 디폴트 메서드가 등장했다. 이번에는 디폴트 메서드가 등장한 배경과 디폴트 메서드에 대해 알아보자.

<br>

## 기존 인터페이스 변경 문제점
디폴트 메서드가 없던 시절에는 인터페이스에 메서드를 추가하면 몇가지 문제가 발생한다.  

첫번째로 인터페이스를 구현하는 기존 모든 클래스들이 해당 메서드를 구현해야 했다.  
참고로 인터페이스에 새로운 메서드를 추가하면 **바이너리 호환성**은 유지된다. 바이너리 호환성이란 새로 추가된 메서드를 호출하지만 않으면 인터페이스를 구현한 클래스에서 추가된 메서드를 구현하지 않아도 기존 클래스 파일이 잘 동작한다는 의미이다. 그러나 호출하게되면 런타임 에러가 발생한다.  

두번째로 메서드가 추가된 인터페이스를 구현한 클래스를 포함한 전체 애플리케이션을 재빌드할 때 컴파일 에러가 발생한다.

이러한 문제들을 해결하기 위해 자바 8에서는 구현을 포함하는 인터페이스를 정의하는 두가지 방법을 제공한다.   
인터페이스 내부에 **정적 메서드**를 사용하는것과 **디폴트 메서드** 기능을 사용하는 것이다. 
결과적으로 인터페이스를 구현하는 클래스들은 자동으로 인터페이스에 추가된 디폴트 메서드를 상속받게 된다.

<br>

### 정적 메서드와 인터페이스
보통 자바에서는 인터페이스와 인터페이스의 인스턴스를 활용할 수 있는 다양한 정적 메서드를 정의하는 유틸리티 클래스를 활용한다.  
예를 들어 Collections는 Collection 객체를 활용할 수 있는 유틸리티 클래스다. 자바 8에서는 인터페이스에 직접 정적 메서드를 선언할 수 있으므로 유틸리티 클래스를 더이상 만들 필요가 없다.(구버전과 호환성을 위해 자바 API에는 유틸리티 클래스가 남아있다.)

<br>

### 바이너리 호환성, 소스 호환성, 동작 호환성
간단하게 뭔가를 바꾼 이후에도 에러 없이 기존 바이너리가 실행될 수 있는 상황을 **바이너리 호환성**이라고 한다.  
**소스 호환성**이란 코드를 고쳐도 기존 프로그램을 성공적으로 재컴파일할 수 있음을 의미한다.  
**동작 호환성**이란 코드를 바꾼 다음에도 같은 입력값이 주어지면 프로그램이 같은 동작을 실행한다는 의미이다.

<br>

## 디폴트 메서드란 무엇인가?
앞서 살펴본 것과 같이 문제점들이 있고, 이를 해결하기 위해 자바 8에서는 호환성을 유지하면서 API를 바꿀 수 있도록 새로운 기능인 **디폴트 메서드**를 제공한다.

아래와 같이 디폴트 메서드는 ``default``라는 키워드로 시작하고, 클래스의 메서드처럼 바디를 포함한다.  
이제 Sized 인터페이스를 구현하는 모든 클래스는 isEmpty의 구현도 상속받는다. 즉, 소스호환성이 유지된다.

```java
public interface Sized {
    int size();
    default boolean isEmpty() {
        return size() == 0;
    }
}
```
> 추상클래스와 자바 8의 인터페이스의 차이점 
> 1. 클래스는 하나의 추상 클래스만 상속받을 수 있지만 인터페이스는 여러개 구현가능한다.  
> 2. 둘째 추상 클래스는 인스턴스 변수를 가질 수 있고, 인터페이스는 그렇지 못하다.

<br>

## 디폴트 메서드 활용 패턴
디폴트 메서드를 이용하는 두가지 방식 **선택형 메서드**와 **동작 다중 상속**에 대해 알아보자.

### 선택형 메서드(optional method)
자바 8 이전에 ``Iterator`` 인터페이스를 구현한 많은 클래스들은 remove 기능을 잘 사용하지 않아, remove에 빈 구현을 제공했다.  
디폴트 메서드를 이용하면 메서드에 기본 구현을 제공할 수 있으므로 구현 클래스에서 빈 구현을 제공할 필요가 없어진다. 즉 불필요한 코드를 줄일 수 있다.

```java
interface Iterator<\T> {
    boolean hasNext();
    T next();
    default void remove() {
        throw new UnsupportedOperationException();
    }
}
```

위처럼 자바 8의 ``Iterator`` 인테페이스에서 remove 메서드를 디폴트 메서드로 구현하여, 기본 구현을 제공한다.

### 동작 다중 상속

